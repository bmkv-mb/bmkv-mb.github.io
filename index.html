<!DOCTYPE html>
<html>
  <head>
    <title>Neukunde Anmeldung</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.3.5/signature_pad.min.js" integrity="sha512-kw/nRM/BMR2XGArXnOoxKOO5VBHLdITAW00aG8qK4zBzcLVZ4nzg7/oYCaoiwc8U9zrnsO9UHqpyljJ8+iqYiQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="apple-touch-icon" type="image/png" href="https://cpwebassets.codepen.io/assets/favicon/apple-touch-icon-5ae1a0698dcc2402e9712f7d01ed509a57814f994c660df9f7a952f3060705ee.png">
  
    <meta name="apple-mobile-web-app-title" content="CodePen">

    <link rel="shortcut icon" type="image/x-icon" href="https://cpwebassets.codepen.io/assets/favicon/favicon-aec34940fbc1a6e787974dcd360f2c6b63348d4b1f4e06c77743096d55480f33.ico">

    <link rel="mask-icon" type="image/x-icon" href="https://cpwebassets.codepen.io/assets/favicon/logo-pin-b4b4269c16397ad2f0f7a01bcdf513a1994f4c94b8af2f191c09eb0d601762b1.svg" color="#111">

    <script src="https://cpwebassets.codepen.io/assets/common/stopExecutionOnTimeout-2c7831bb44f98c1391d6a4ffda0e1fd302503391ca806e7fcc7b9b87197aec26.js"></script>
      
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <script src="https://superal.github.io/canvas2image/canvas2image.js"></script>
    
  <body>
   
    <div class="testbox">
      <form onsubmit="saveFormAsTextFile()" action="" id="email_send">

        <div class="banner">
          <h1>Anmeldung</h1>
        </div>
		<div style="padding-top: 10px; padding-bottom: 10px; ">
			<h3>Personalien Neukunden</h3>
		</div>
        <div class="colums" style="padding-bottom:10px;">
          <div class="item">
            <label for="fname"> Vorname1<span>*</span></label>
            <input onchange="sendEmail()" id="fname" type="text" name="fname" required/>
          </div>
          <div class="item">
            <label for="lname"> Nachname<span>*</span></label>
            <input onchange="sendEmail()" id="lname" type="text" name="lname" required/>
          </div>
          <div class="item">
            <label for="address1">Addresse<span>*</span></label>
            <input id="address1" type="text"   name="address1" required/>
          </div>
          <div class="item">
            <label for="postfach">Postfach</label>
            <input id="postfach" type="text"   name="postfach"/>
          </div>
          <div class="item">
            <label for="city">Ort<span>*</span></label>
            <input id="city" type="text"   name="city" required/>
          </div>
          <div class="item">
            <label for="plz">PLZ<span>*</span></label>
            <input id="plz" type="text" name="plz" required/>
          </div>
          <div class="item">
            <label for="eaddress">Email-Addresse<span>*</span></label>
            <input onchange="sendEmail()" id="eaddress" type="email" name="eaddress"  required/>
          </div>
          <div class="item">
            <label for="phone">Telefonummer<span>*</span></label>
            <input id="phone" type="number" name="phone"  required/>
          </div>
		  <div class="item">
            <label for="iban">IBAN<span>*</span></label>
            <input id="iban" type="text" minlength="26" maxlength="26" name="iban" placeholder="CH01 2222 3333 4444 5555 6" required >
          </div>
		  <div class="item">
            <label for="bankname">Name der Bank<span>*</span></label>
            <input id="bankname" type="text" name="bankname" required/>
          </div>
          <div style="padding-top: 10px; padding-bottom:10px;">
            <input class="input_checkbox" type="checkbox" id="checkbox_alternative_address" onclick="showMe('hidden_input')"> Abweichende Kontendaten</input>
          </div>
          <!---->
          <div></div>
          <!---->
          <div class="item" id="hidden_input" style="display: none;" name="hidden">
            <label for="alt_vorname">Vorname<span>*</span></label>
            <input id="alt_vorname" type="text" name="alt_vorname" />
          </div>
          <div class="item" id="hidden_input" style="display: none;" name="hidden">
            <label for="alt_nachname"> Nachname<span>*</span></label>
            <input id="alt_nachname" type="text" name="alt_nachname"/>
          </div>
          <div class="item" id="hidden_input" style="display: none;" name="hidden">
            <label for="alt_address">Addresse<span>*</span></label>
            <input id="alt_address" type="text" name="alt_address" />
          </div>
		  <div class="item" id="hidden_input" style="display: none;" name="hidden">
            <label for="alt_postfach">Postfach</label>
            <input id="alt_postfach" type="text" name="alt_postfach" />
          </div>
          <div class="item" id="hidden_input" style="display: none;" name="hidden">
            <label for="alt_plz">PLZ<span>*</span></label>
            <input id="alt_plz" type="text" name="alt_plz" />
          </div>
          <div class="item" id="hidden_input" style="display: none;" name="hidden">
            <label for="alt_city">Ort<span>*</span></label>
            <input id="alt_city" type="text" name="alt_city" />
          </div>
		  <!-- BENÖTIGT? --> 
		  <!--<div class="item" id="hidden_input" style="display: none;" name="hidden">
            <label for="iban">IBAN<span>*</span></label>
            <input id="iban" type="text" minlength="26" maxlength="26" name="iban" placeholder="CH01 2222 3333 4444 5555 6" required >
          </div>
		  <div class="item" id="hidden_input" style="display: none;" name="hidden">
            <label for="bankname">Name der Bank<span>*</span></label>
            <input id="bankname" type="text" name="bankname" required>
          </div>-->

        </div>
		<div class="form-2 & colums">
		  <div style=" padding-bottom: 10px;" >
			<h3>Wie haben Sie von uns erfahren?</h3>
		  </div>
		  <div></div>
		  <div>
			<input style="width:auto;" type="checkbox"> Mündl. Empfehlung</input>
		  </div>
		  <div>
			<input style="width:auto;" type="checkbox"> Ricardo-Newsletter</input>
		  </div>
		  <div>
			<input style="width:auto;" type="checkbox"> Facebook / Instagram</input>
		  </div>
		  <div>
			<input style="width:auto;" type="checkbox"> Flyer</input>
		  </div>
		  <div style="padding-top:5px;">
			<label> Weitere: </label>
			<input style="width:auto; padding-top:15px;" type="text"> </input>
		  </div>
		</div>
        <div style="padding-top: 20px;">
			<h2>AGBs</h2>
          <!--<input class="input_checkbox" type="checkbox" id="AGBs">-->
        </div>
		<div style="padding-top: 20px;">
			<label>
				Mit Ihrer Unterschrift bestätigen Sie die Richtigkeit Ihrer Angaben und akzeptieren unsere AGB (siehe E-Mail Anhang). 
				Ihre Angaben werden zu keinem Zeitpunkt an Dritte weitergegeben. Ihre Mailadresse kann, bei Veränderungen unserer AGB oder Dienstleistung, zu Informationszwecken verwendet werden.
			</label>
        </div>
		<div style="padding-top: 20px; font-weight: bold;">
			<h4>Unterschrift</h4>
        </div>
        <div  class="flex-row" >
          <div class="wrapper" style="padding-bottom: 10px;">
              <canvas id="signature-pad" height="100"></canvas>
          </div>
      </div>
      <div>
        <button type="submit" id="submit" class="btn btn-default" href="/">Submit</button>
      </div>

      <script id="rendered-js">

      function saveForm() {
      html2canvas(document.querySelector('.testbox'), {
      onrendered: function (canvas) {
      //document.body.appendChild(canvas);
      return Canvas2Image.saveAsPNG(canvas);
      } });
    
      };
      //# sourceURL=pen.js
      </script>

      </form>
    </div>

  <script type="text/javascript" >      
    var canvas = document.getElementById("signature-pad");

    <!--function resizeCanvas() {
    <!--    var ratio = Math.max(window.devicePixelRatio || 1, 1);
    <!--    canvas.width = canvas.offsetWidth * ratio;
     <!--   canvas.height = canvas.offsetHeight * ratio;
    <!--    canvas.getContext("2d").scale(ratio, ratio);
    <!--}
	
   <!-- window.onresize = resizeCanvas;
    <!--resizeCanvas();

    var signaturePad = new SignaturePad(canvas, {
    backgroundColor: 'rgb(250,250,250)'
    });

    document.getElementById("clear").addEventListener('click', function(){
    signaturePad.clear();
    })
     // Current date - http://stackoverflow.com/a/4929629/412329
    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();

    if(dd<10) {
        dd='0'+dd
        } 

    if(mm<10) {
        mm='0'+mm
        } 

    today = dd + '-' + mm + '-' + yyyy;


    function saveFormAsTextFile()
        // Based on https://thiscouldbebetter.wordpress.com/2012/12/18/loading-editing-and-saving-a-text-file-in-html5-using-javascrip/
    {
      var alt_add_checkbox = document.getElementById("checkbox_alternative_address")
      var textToSave = ""

        if(alt_add_checkbox.checked == true)
        {
        textToSave =
        'Datum: ' + today + '\n' +
        'Vorname: ' + document.getElementById('fname').value + '\n' + 
        'Nachname: ' + document.getElementById('lname').value + '\n' + 
        'Adresse: ' + document.getElementById('address1').value + '\n' + 
        'IBAN: ' + document.getElementById('iban').value + '\n' + 
        'PLZ: ' + document.getElementById('plz').value + '\n' + 
        'Ort: ' + document.getElementById('city').value + '\n' + 
        'Email: ' + document.getElementById('eaddress').value + '\n' + 
        'Telefon: ' + document.getElementById('phone').value + '\n' + 
        '\n'+
        'Alternative Adresse: ' + '\n' + 
        'Vorname: ' + document.getElementById('alt_vorname').value + '\n' + 
        'Nachname: ' + document.getElementById('alt_nachname').value + '\n' + 
        'Adresse: ' + document.getElementById('alt_address').value + '\n' + 
        'PLZ: ' + document.getElementById('alt_plz').value + '\n' + 
        'Ort: ' + document.getElementById('alt_city').value + '\n';
        }
        else
        {
          textToSave =
          'Datum: ' + today + '\n' +
          'Vorname: ' + document.getElementById('fname').value + '\n' + 
          'Nachname: ' + document.getElementById('lname').value + '\n' + 
          'Adresse: ' + document.getElementById('address1').value + '\n' + 
          'IBAN: ' + document.getElementById('iban').value + '\n' + 
          'PLZ: ' + document.getElementById('plz').value + '\n' + 
          'Ort: ' + document.getElementById('city').value + '\n' + 
          'Email: ' + document.getElementById('eaddress').value + '\n' + 
          'Telefon: ' + document.getElementById('phone').value + '\n';
        }

      var textToSaveAsBlob = new Blob([textToSave], {type:"text/csv"});
      var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
      var fileNameToSaveAs = document.getElementById('fname').value + ' ' +document.getElementById('lname').value;

      var downloadLink = document.createElement("a");
      downloadLink.download = fileNameToSaveAs;
      downloadLink.innerHTML = "Download File";
      downloadLink.href = textToSaveAsURL;
      downloadLink.onclick = destroyClickedElement;
      downloadLink.style.display = "none";
      document.body.appendChild(downloadLink);

      downloadLink.click();
	  saveForm();
    }

    function destroyClickedElement(event)
    {
      document.body.removeChild(event.target);
    }
    
    function showMe (box) 
    {
      var divs = document.getElementsByName('hidden')
      var checkbox = document.getElementById("checkbox_alternative_address")
      for(var i=0;i<divs.length;i++) { 
        if(checkbox.checked == true) {
          divs[i].style.display = "block";
          }
        else{
          divs[i].style.display = "none";
          }
        }
    }
    function sendEmail() 
    {
      var link = document.getElementById('email_send');
      var name = document.getElementById('fname').value + ' ' + document.getElementById('lname').value;
      var message = 'Sehr geehrte/r ' + name;
      var subject = 'Neuanmeldung und AGBs';
      var attachement = 'C:/Users/miroslav.blascanin/Desktop/Restwert Formular/text.txt'
      var email = document.getElementById('eaddress').value;
      var action = "mailto:" + email + "&subject=" + subject + "&body=" + message + "&attachment=" + attachement;
      
      link.setAttribute("action", action);
    }   
    
  </script>

  </body>
</html>
